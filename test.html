<!DOCTYPE html>
<html>
<head>
    <title>擷取鏡頭畫面成為圖片</title>
</head>
<body>
    <video id="video" autoplay></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <img id="snapshot" src="">
    <button id="toggleSnapshot">開始擷取</button>

    <script>
        const video = document.querySelector('#video');
        const canvas = document.querySelector('#canvas');
        const snapshot = document.querySelector('#snapshot');
        const toggleSnapshotButton = document.querySelector('#toggleSnapshot');
        const context = canvas.getContext('2d');
        let snapshotIntervalId = null;

        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function(stream) {
                    video.srcObject = stream;
                })
                .catch(function(error) {
                    console.log("錯誤發生了!", error);
                });
        }

        function takeSnapshot() {
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            const blob = canvas.toBlob(blob => upload(blob), 'image/png');
        }

        toggleSnapshotButton.addEventListener('click', function() {
            if (snapshotIntervalId) {
                clearInterval(snapshotIntervalId);
                snapshotIntervalId = null;
                toggleSnapshotButton.textContent = '開始擷取';
            } else {
                snapshotIntervalId = setInterval(takeSnapshot, 1000); // 每隔1秒擷取一次
                toggleSnapshotButton.textContent = '停止擷取';
            }
        });

        async function upload(blob) {
            // 前述 upload() 函數的程式碼
        }
    </script>
</body>
</html>
